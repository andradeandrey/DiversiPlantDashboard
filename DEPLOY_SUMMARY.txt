â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“¦ PACOTE DE DEPLOY - DIVERSIPLANT QUERY EXPLORER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Data: 2026-02-04
ğŸ¯ VersÃ£o: v2.0 - Unified Climate Envelopes
ğŸ‘¤ ResponsÃ¡vel: Andrey Andrade

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“‚ ARQUIVOS INCLUÃDOS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. BINÃRIO GO
   query-explorer/query-explorer-linux (9.7 MB)
   â”œâ”€ Endpoint: POST /api/recommend
   â”œâ”€ Endpoint: GET /api/ecoregion/species
   â””â”€ Usa VIEW unificada de climate envelopes

2. MIGRATIONS SQL
   database/migrations/010_climate_envelope_system.sql (14 KB)
   â”œâ”€ Tabela: climate_envelope_gbif
   â”œâ”€ Tabela: climate_envelope_ecoregion
   â””â”€ FunÃ§Ã£o: calculate_climate_match()

   database/migrations/011_unified_climate_envelope_view.sql (5.5 KB)
   â””â”€ VIEW: species_climate_envelope_unified
      (prioriza GBIF > Ecoregion > WCVP)

3. SCRIPTS DE POPULAÃ‡ÃƒO
   scripts/populate-wcvp-envelopes.sql (3.2 KB)
   â””â”€ Popula ~362,000 envelopes WCVP

   scripts/populate-ecoregion-envelopes.sql (4.6 KB)
   â””â”€ Popula ~46,767 envelopes TreeGOER

4. SCRIPT DE DEPLOY
   scripts/deploy-to-diversiplant.sh (6.8 KB)
   â””â”€ Automatiza todo o processo

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ¯ RESULTADO ESPERADO
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š COBERTURA DE ENVELOPES:
   Antes:  156,185 espÃ©cies (47.5%)
   Depois: 181,932 espÃ©cies (55.4%)
   Ganho:  +25,747 espÃ©cies (+16.5%)

ğŸŒ³ COBERTURA DE ÃRVORES:
   Antes:  23,694 Ã¡rvores (41.4%)
   Depois: 42,295 Ã¡rvores (73.9%)
   Ganho:  +18,601 Ã¡rvores (+78.5%) ğŸ‰

ğŸ“ˆ DISTRIBUIÃ‡ÃƒO POR FONTE:
   GBIF:      15,878 espÃ©cies (8.7%)  - Alta qualidade
   Ecoregion: 46,867 espÃ©cies (25.8%) - TreeGOER
   WCVP:     119,187 espÃ©cies (65.5%) - Cobertura global

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš™ï¸  MUDANÃ‡AS NO SISTEMA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… BACKEND:
   â€¢ Novo endpoint /api/recommend para recomendaÃ§Ãµes
   â€¢ Algoritmo Greedy de maximizaÃ§Ã£o de diversidade
   â€¢ CÃ¡lculo de Gower distance para traits
   â€¢ Cache de recomendaÃ§Ãµes (24h TTL)

âœ… BANCO DE DADOS:
   â€¢ 3 tabelas novas de climate envelopes
   â€¢ VIEW unificada com priorizaÃ§Ã£o inteligente
   â€¢ FunÃ§Ã£o SQL calculate_climate_match()
   â€¢ Ãndices otimizados para performance

âœ… INTEGRAÃ‡ÃƒO:
   â€¢ GBIF occurrences individuais (lat/lon)
   â€¢ TreeGOER ecoregion data (46k Ã¡rvores)
   â€¢ WCVP regional climate aggregation

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸš€ COMO EXECUTAR O DEPLOY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

cd /Users/andreyandrade/Code/DiversiPlantDashboard-sticky
./scripts/deploy-to-diversiplant.sh

O script irÃ¡:
1. âœ… Fazer backup do banco (pg_dump comprimido)
2. âœ… Parar o servidor atual
3. âœ… Enviar novo binÃ¡rio (9.7 MB)
4. âœ… Enviar migrations (010 + 011)
5. âœ… Aplicar migrations no PostgreSQL
6. âœ… Popular envelopes (WCVP + Ecoregion)
7. âœ… Iniciar novo servidor

Tempo estimado: 5-10 minutos
Downtime: ~2 minutos (durante restart)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” VERIFICAÃ‡ÃƒO PÃ“S-DEPLOY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Health check:
   curl http://localhost:8080/api/health

2. Verificar envelopes:
   docker exec diversiplant-db psql -U diversiplant -d diversiplant \
     -c "SELECT envelope_source, COUNT(*) FROM
         species_climate_envelope_unified GROUP BY envelope_source;"

3. Testar recomendaÃ§Ã£o:
   curl -X POST http://localhost:8080/api/recommend \
     -H "Content-Type: application/json" \
     -d '{"tdwg_code":"BZS","n_species":10}'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸  OBSERVAÃ‡Ã•ES IMPORTANTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ Backup automÃ¡tico serÃ¡ criado antes de qualquer mudanÃ§a
â€¢ Envelopes GBIF (~15k) jÃ¡ foram processados previamente
â€¢ PopulaÃ§Ã£o de WCVP e Ecoregion leva ~5 minutos cada
â€¢ VIEW unificada nÃ£o duplica dados, apenas prioriza fontes
â€¢ Rollback disponÃ­vel via restore do backup

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ SUPORTE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Logs: tail -f /opt/diversiplant/logs/query-explorer.log
Docker: docker ps | grep diversiplant-db
Health: curl localhost:8080/api/health

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
